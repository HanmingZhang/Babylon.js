var __extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(n,t){function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),BABYLON;!(function(e){var n=(function(n){function t(t,r,o,i){var s=n.call(this,t,"sobeledgedetection",["width","height","edgeThickness"],["sceneSampler"],{width:r.getEngine().getRenderWidth(),height:r.getEngine().getRenderHeight()},r,e.Texture.TRILINEAR_SAMPLINGMODE,r.getEngine(),!0)||this;return s._edgeThickness=1,s._minEdgeThickness=.5,s._maxEdgeThickness=4,console.log("input thickness",o),s._edgeThickness=Math.min(Math.max(o,s._minEdgeThickness),s._maxEdgeThickness),s.onApply=function(e){e.setTextureFromPostProcess("sceneSampler",i),e.setFloat("width",s.width),e.setFloat("height",s.height),e.setFloat("edgeThickness",s._edgeThickness)},s}return __extends(t,n),t})(e.PostProcess);e.EdgeDetectionPostProcess=n})(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(n,t){function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),BABYLON;!(function(e){var n=(function(n){function t(t,r,o,i){var s=n.call(this,t,"posterization",["gamma","numColors"],null,{width:r.getEngine().getRenderWidth(),height:r.getEngine().getRenderHeight()},r,e.Texture.TRILINEAR_SAMPLINGMODE,r.getEngine(),!0)||this;return s._gamma=.6,s._numColors=8,console.log("input gamma",o),s._gamma=o,console.log("input numColors",i),s._numColors=i,s.onApply=function(e){e.setFloat("gamma",s._gamma),e.setFloat("numColors",s._numColors)},s}return __extends(t,n),t})(e.PostProcess);e.PosterizationPostProcess=n})(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(n,t){function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),BABYLON;!(function(e){var n=(function(n){function t(t,r,o,i,s,a,c){var u=n.call(this,t,"paper",null,["othertexture"],o,i,s,a,c)||this;return u._othertexture=null,u._othertexture=r?new e.Texture(r,i.getScene(),!0):null,u.onApplyObservable.add((function(e){e.setTexture("othertexture",u._othertexture)})),u}return __extends(t,n),t})(e.PostProcess);e.paperPostProcess=n})(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(n,t){function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),BABYLON;!(function(e){var n=(function(e){function n(n,t,r,o,i,s,a){var c=e.call(this,n,"kuwahara",["radius","width","height"],null,{width:o.getEngine().getRenderWidth(),height:o.getEngine().getRenderHeight()},o,i,s,a)||this;return c._radius=3,"number"==typeof r&&(console.log("input radius",r),c._radius=r),c.onApplyObservable.add((function(e){e.setFloat("radius",c._radius),e.setFloat("width",c.width),e.setFloat("height",c.height)})),c}return __extends(n,e),n})(e.PostProcess);e.kuwaharaPostProcess=n})(BABYLON||(BABYLON={}));var __extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(n,t){function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),BABYLON;!(function(e){var n=(function(n){function t(t,r,o,i,s,a,c){var u=n.call(this,t,"frame",null,["othertexture"],o,i,s,a,c)||this;return u._othertexture=null,u._othertexture=r?new e.Texture(r,i.getScene(),!0):null,u.onApplyObservable.add((function(e){e.setTexture("othertexture",u._othertexture)})),u}return __extends(t,n),t})(e.PostProcess);e.framePostProcess=n})(BABYLON||(BABYLON={})),BABYLON.Effect.ShadersStore.sobeledgedetectionPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D sceneSampler;\nuniform float width;\nuniform float height;\nuniform float edgeThickness;\nvoid make_kernel(inout vec4 n[9],sampler2D tex,vec2 coord)\n{\nfloat w=edgeThickness/width;\nfloat h=edgeThickness/height;\nn[0]=texture2D(tex,coord+vec2( -w,-h));\nn[1]=texture2D(tex,coord+vec2(0.0,-h));\nn[2]=texture2D(tex,coord+vec2( w,-h));\nn[3]=texture2D(tex,coord+vec2( -w,0.0));\nn[4]=texture2D(tex,coord);\nn[5]=texture2D(tex,coord+vec2( w,0.0));\nn[6]=texture2D(tex,coord+vec2( -w,h));\nn[7]=texture2D(tex,coord+vec2(0.0,h));\nn[8]=texture2D(tex,coord+vec2( w,h));\n}\nvoid main(void) \n{\nvec4 n[9];\nmake_kernel( n,sceneSampler,vUV );\nvec4 sobel_edge_h=n[2]+(2.0*n[5])+n[8]-(n[0]+(2.0*n[3])+n[6]);\nvec4 sobel_edge_v=n[0]+(2.0*n[1])+n[2]-(n[6]+(2.0*n[7])+n[8]);\nvec4 sobel=sqrt((sobel_edge_h*sobel_edge_h)+(sobel_edge_v*sobel_edge_v));\nfloat minGradChannel=min(sobel.r,min(sobel.g,sobel.b));\ngl_FragColor=vec4( 1.0-vec3(minGradChannel),1.0 );\n}\n",BABYLON.Effect.ShadersStore.posterizationPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform float gamma; \nuniform float numColors; \nvoid main(void) \n{ \nvec3 c=texture2D(textureSampler,vUV).rgb;\nc=pow(c,vec3(gamma,gamma,gamma));\nc=c*numColors;\nc=floor(c);\nc=c/numColors;\nc=pow(c,vec3(1.0/gamma));\ngl_FragColor=vec4(c,1.0);\n}\n",BABYLON.Effect.ShadersStore.composePixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\n\nuniform sampler2D sceneSampler;\nvoid main(void) \n{\n\ngl_FragColor=texture2D(textureSampler,vUV)*texture2D(sceneSampler,vUV);\n}",BABYLON.Effect.ShadersStore.paperPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D othertexture;\nvoid main(void) \n{\nvec3 color=texture2D(textureSampler,vUV).rgb*texture2D(othertexture,vUV).rgb;\ngl_FragColor=vec4(color,1.0);\n}",BABYLON.Effect.ShadersStore.kuwaharaPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform float radius;\nuniform float width;\nuniform float height;\nvoid main(void) \n{ \nint loopTimes=int(radius);\nvec2 src_size=vec2 (1.0/width,1.0/height);\nfloat n=(radius+1.0)*(radius+1.0);\nint i; \nint j;\nvec3 m0=vec3(0.0); vec3 m1=vec3(0.0); vec3 m2=vec3(0.0); vec3 m3=vec3(0.0);\nvec3 s0=vec3(0.0); vec3 s1=vec3(0.0); vec3 s2=vec3(0.0); vec3 s3=vec3(0.0);\nvec3 c;\nfor (int j=-loopTimes; j<=0; ++j) {\nfor (int i=-loopTimes; i<=0; ++i) {\nc=texture2D(textureSampler,vUV+vec2(i,j)*src_size).rgb;\nm0+=c;\ns0+=c*c;\n}\n}\nfor (int j=-loopTimes; j<=0; ++j) {\nfor (int i=0; i<=loopTimes; ++i) {\nc=texture2D(textureSampler,vUV+vec2(i,j)*src_size).rgb;\nm1+=c;\ns1+=c*c;\n}\n}\nfor (int j=0; j<=loopTimes; ++j) {\nfor (int i=0; i<=loopTimes; ++i) {\nc=texture2D(textureSampler,vUV+vec2(i,j)*src_size).rgb;\nm2+=c;\ns2+=c*c;\n}\n}\nfor (int j=0; j<=loopTimes; ++j) {\nfor (int i=-loopTimes; i<=0; ++i) {\nc=texture2D(textureSampler,vUV+vec2(i,j)*src_size).rgb;\nm3+=c;\ns3+=c*c;\n}\n}\nfloat min_sigma2=100.0;\nm0/=n;\ns0=abs(s0/n-m0*m0);\nfloat sigma2=s0.r+s0.g+s0.b;\nif (sigma2<min_sigma2) {\nmin_sigma2=sigma2;\ngl_FragColor=vec4(m0,1.0);\n}\nm1/=n;\ns1=abs(s1/n-m1*m1);\nsigma2=s1.r+s1.g+s1.b;\nif (sigma2<min_sigma2) {\nmin_sigma2=sigma2;\ngl_FragColor=vec4(m1,1.0);\n}\nm2/=n;\ns2=abs(s2/n-m2*m2);\nsigma2=s2.r+s2.g+s2.b;\nif (sigma2<min_sigma2) {\nmin_sigma2=sigma2;\ngl_FragColor=vec4(m2,1.0);\n}\n}",BABYLON.Effect.ShadersStore.framePixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D othertexture;\nvoid main(void) \n{\nvec3 framecolor=texture2D(othertexture,vUV).rgb;\nfloat alpha=texture2D(othertexture,vUV).a;\ngl_FragColor=vec4(texture2D(textureSampler,vUV).rgb*(1.0-alpha)+framecolor*alpha,1.0);\n}";