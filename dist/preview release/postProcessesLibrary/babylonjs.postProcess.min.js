var globalObject="undefined"!=typeof global?global:"undefined"!=typeof window?window:this,babylonDependency=globalObject&&globalObject.BABYLON||BABYLON||"undefined"!=typeof require&&require("babylonjs"),BABYLON=babylonDependency,__decorate=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},__extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}})(),BABYLON;!(function(e){var t=(function(t){function n(n,o,r,i){void 0===i&&(i=null);var a=t.call(this,i)||this;if(!(i=a.getScene()))return a;a.name=n,a._text,a._font,a.wrapU=e.Texture.CLAMP_ADDRESSMODE,a.wrapV=e.Texture.CLAMP_ADDRESSMODE;var l=a.getFontHeight(o),c=a.getFontWidth(o);a._charSize=Math.max(l.height,c);var s=Math.ceil(a._charSize*r.length),f=a._charSize;a._texture=i.getEngine().createDynamicTexture(s,f,!1,e.Texture.NEAREST_SAMPLINGMODE);var u=a.getSize(),g=document.createElement("canvas");g.width=u.width,g.height=u.height;var d=g.getContext("2d");d.textBaseline="top",d.font=o,d.fillStyle="white",d.imageSmoothingEnabled=!1;for(var m=0;m<r.length;m++)d.fillText(r[m],m*a._charSize,-l.offset);return i.getEngine().updateDynamicTexture(a._texture,g,!1,!0),a}return __extends(n,t),Object.defineProperty(n.prototype,"charSize",{get:function(){return this._charSize},enumerable:!0,configurable:!0}),n.prototype.getFontWidth=function(e){var t=document.createElement("canvas"),n=t.getContext("2d");return n.fillStyle="white",n.font=e,n.measureText("W").width},n.prototype.getFontHeight=function(e){var t=document.createElement("canvas"),n=t.getContext("2d");n.fillRect(0,0,t.width,t.height),n.textBaseline="top",n.fillStyle="white",n.font=e,n.fillText("jH|",0,0);for(var o=n.getImageData(0,0,t.width,t.height).data,r=-1,i=-1,a=0;a<t.height;a++)for(var l=0;l<t.width;l++){var c=4*(a*t.width+l);{if(0!==o[c]){-1===r&&(r=a);break}if(l===t.width-1&&-1!==r){i=a,a=t.height;break}}}return{height:i-r+1,offset:r-1}},n.prototype.clone=function(){return new n(this.name,this._font,this._text,this.getScene())},n.Parse=function(t,o){return e.SerializationHelper.Parse((function(){return new n(t.name,t.font,t.text,o)}),t,o,null)},__decorate([e.serialize("font")],n.prototype,"_font",void 0),__decorate([e.serialize("text")],n.prototype,"_text",void 0),n})(e.BaseTexture);e.AsciiArtFontTexture=t;var n=(function(n){function o(o,r,i){var a=n.call(this,o,"asciiart",["asciiArtFontInfos","asciiArtOptions"],["asciiArtFont"],{width:r.getEngine().getRenderWidth(),height:r.getEngine().getRenderHeight()},r,e.Texture.TRILINEAR_SAMPLINGMODE,r.getEngine(),!0)||this;a.mixToTile=0,a.mixToNormal=0;var l="40px Monospace",c=" `-.'_:,\"=^;<+!*?/cL\\zrs7TivJtC{3F)Il(xZfY5S2eajo14[nuyE]P6V9kXpKwGhqAUbOd8#HRDB0$mgMW&Q%N@";i&&("string"==typeof i?l=i:(l=i.font||l,c=i.characterSet||c,a.mixToTile=i.mixToTile||a.mixToTile,a.mixToNormal=i.mixToNormal||a.mixToNormal)),a._asciiArtFontTexture=new t(o,l,c,r.getScene());var s=a._asciiArtFontTexture.getSize();return a.onApply=function(e){e.setTexture("asciiArtFont",a._asciiArtFontTexture),e.setFloat4("asciiArtFontInfos",a._asciiArtFontTexture.charSize,c.length,s.width,s.height),e.setFloat4("asciiArtOptions",a.width,a.height,a.mixToNormal,a.mixToTile)},a}return __extends(o,n),o})(e.PostProcess);e.AsciiArtPostProcess=n})(BABYLON||(BABYLON={})),BABYLON.Effect.ShadersStore.asciiartPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D asciiArtFont;\n\nuniform vec4 asciiArtFontInfos;\nuniform vec4 asciiArtOptions;\n\nfloat getLuminance(vec3 color)\n{\nreturn clamp(dot(color,vec3(0.2126,0.7152,0.0722)),0.,1.);\n}\n\nvoid main(void) \n{\nfloat caracterSize=asciiArtFontInfos.x;\nfloat numChar=asciiArtFontInfos.y-1.0;\nfloat fontx=asciiArtFontInfos.z;\nfloat fonty=asciiArtFontInfos.w;\nfloat screenx=asciiArtOptions.x;\nfloat screeny=asciiArtOptions.y;\nfloat tileX=float(floor((gl_FragCoord.x)/caracterSize))*caracterSize/screenx;\nfloat tileY=float(floor((gl_FragCoord.y)/caracterSize))*caracterSize/screeny;\nvec2 tileUV=vec2(tileX,tileY);\nvec4 tileColor=texture2D(textureSampler,tileUV);\nvec4 baseColor=texture2D(textureSampler,vUV);\nfloat tileLuminance=getLuminance(tileColor.rgb);\nfloat offsetx=(float(floor(tileLuminance*numChar)))*caracterSize/fontx;\nfloat offsety=0.0;\nfloat x=float(mod(gl_FragCoord.x,caracterSize))/fontx;\nfloat y=float(mod(gl_FragCoord.y,caracterSize))/fonty;\nvec4 finalColor=texture2D(asciiArtFont,vec2(offsetx+x,offsety+(caracterSize/fonty-y)));\nfinalColor.rgb*=tileColor.rgb;\nfinalColor.a=1.0;\nfinalColor=mix(finalColor,tileColor,asciiArtOptions.w);\nfinalColor=mix(finalColor,baseColor,asciiArtOptions.z);\ngl_FragColor=finalColor;\n}";var BABYLON;!(function(e){var t=(function(t){function n(n,o,r,i){void 0===i&&(i=null);var a=t.call(this,i)||this;if(!(i=a.getScene()))return a;a.name=n,a._text,a._font,a.wrapU=e.Texture.CLAMP_ADDRESSMODE,a.wrapV=e.Texture.CLAMP_ADDRESSMODE;var l=a.getFontHeight(o),c=a.getFontWidth(o);a._charSize=Math.max(l.height,c);var s=a._charSize,f=Math.ceil(a._charSize*r.length);a._texture=i.getEngine().createDynamicTexture(s,f,!1,e.Texture.NEAREST_SAMPLINGMODE);var u=a.getSize(),g=document.createElement("canvas");g.width=u.width,g.height=u.height;var d=g.getContext("2d");d.textBaseline="top",d.font=o,d.fillStyle="white",d.imageSmoothingEnabled=!1;for(var m=0;m<r.length;m++)d.fillText(r[m],0,m*a._charSize-l.offset);return i.getEngine().updateDynamicTexture(a._texture,g,!1,!0),a}return __extends(n,t),Object.defineProperty(n.prototype,"charSize",{get:function(){return this._charSize},enumerable:!0,configurable:!0}),n.prototype.getFontWidth=function(e){var t=document.createElement("canvas"),n=t.getContext("2d");return n.fillStyle="white",n.font=e,n.measureText("W").width},n.prototype.getFontHeight=function(e){var t=document.createElement("canvas"),n=t.getContext("2d");n.fillRect(0,0,t.width,t.height),n.textBaseline="top",n.fillStyle="white",n.font=e,n.fillText("jH|",0,0);for(var o=n.getImageData(0,0,t.width,t.height).data,r=-1,i=-1,a=0;a<t.height;a++)for(var l=0;l<t.width;l++){var c=4*(a*t.width+l);{if(0!==o[c]){-1===r&&(r=a);break}if(l===t.width-1&&-1!==r){i=a,a=t.height;break}}}return{height:i-r+1,offset:r-1}},n.prototype.clone=function(){return new n(this.name,this._font,this._text,this.getScene())},n.Parse=function(t,o){return e.SerializationHelper.Parse((function(){return new n(t.name,t.font,t.text,o)}),t,o,null)},__decorate([e.serialize("font")],n.prototype,"_font",void 0),__decorate([e.serialize("text")],n.prototype,"_text",void 0),n})(e.BaseTexture);e.DigitalRainFontTexture=t;var n=(function(n){function o(o,r,i){var a=n.call(this,o,"digitalrain",["digitalRainFontInfos","digitalRainOptions","cosTimeZeroOne","matrixSpeed"],["digitalRainFont"],{width:r.getEngine().getRenderWidth(),height:r.getEngine().getRenderHeight()},r,e.Texture.TRILINEAR_SAMPLINGMODE,r.getEngine(),!0)||this;a.mixToTile=0,a.mixToNormal=0;var l="15px Monospace",c="古池や蛙飛び込む水の音ふるいけやかわずとびこむみずのおと初しぐれ猿も小蓑をほしげ也はつしぐれさるもこみのをほしげなり江戸の雨何石呑んだ時鳥えどのあめなんごくのんだほととぎす";i&&("string"==typeof i?l=i:(l=i.font||l,a.mixToTile=i.mixToTile||a.mixToTile,a.mixToNormal=i.mixToNormal||a.mixToNormal)),a._digitalRainFontTexture=new t(o,l,c,r.getScene());for(var s=a._digitalRainFontTexture.getSize(),f=0,u=0,g=new e.Matrix,d=0;d<16;d++)g.m[d]=Math.random();return a.onApply=function(e){e.setTexture("digitalRainFont",a._digitalRainFontTexture),e.setFloat4("digitalRainFontInfos",a._digitalRainFontTexture.charSize,c.length,s.width,s.height),e.setFloat4("digitalRainOptions",a.width,a.height,a.mixToNormal,a.mixToTile),e.setMatrix("matrixSpeed",g),f+=.003,u=f,e.setFloat("cosTimeZeroOne",u)},a}return __extends(o,n),o})(e.PostProcess);e.DigitalRainPostProcess=n})(BABYLON||(BABYLON={})),BABYLON.Effect.ShadersStore.digitalrainPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D digitalRainFont;\n\nuniform vec4 digitalRainFontInfos;\nuniform vec4 digitalRainOptions;\nuniform mat4 matrixSpeed;\nuniform float cosTimeZeroOne;\n\nfloat getLuminance(vec3 color)\n{\nreturn clamp(dot(color,vec3(0.2126,0.7152,0.0722)),0.,1.);\n}\n\nvoid main(void) \n{\nfloat caracterSize=digitalRainFontInfos.x;\nfloat numChar=digitalRainFontInfos.y-1.0;\nfloat fontx=digitalRainFontInfos.z;\nfloat fonty=digitalRainFontInfos.w;\nfloat screenx=digitalRainOptions.x;\nfloat screeny=digitalRainOptions.y;\nfloat ratio=screeny/fonty;\nfloat columnx=float(floor((gl_FragCoord.x)/caracterSize));\nfloat tileX=float(floor((gl_FragCoord.x)/caracterSize))*caracterSize/screenx;\nfloat tileY=float(floor((gl_FragCoord.y)/caracterSize))*caracterSize/screeny;\nvec2 tileUV=vec2(tileX,tileY);\nvec4 tileColor=texture2D(textureSampler,tileUV);\nvec4 baseColor=texture2D(textureSampler,vUV);\nfloat tileLuminance=getLuminance(tileColor.rgb);\nint st=int(mod(columnx,4.0));\nfloat speed=cosTimeZeroOne*(sin(tileX*314.5)*0.5+0.6); \nfloat x=float(mod(gl_FragCoord.x,caracterSize))/fontx;\nfloat y=float(mod(speed+gl_FragCoord.y/screeny,1.0));\ny*=ratio;\nvec4 finalColor=texture2D(digitalRainFont,vec2(x,1.0-y));\nvec3 high=finalColor.rgb*(vec3(1.2,1.2,1.2)*pow(1.0-y,30.0));\nfinalColor.rgb*=vec3(pow(tileLuminance,5.0),pow(tileLuminance,1.5),pow(tileLuminance,3.0));\nfinalColor.rgb+=high;\nfinalColor.rgb=clamp(finalColor.rgb,0.,1.);\nfinalColor.a=1.0;\nfinalColor=mix(finalColor,tileColor,digitalRainOptions.w);\nfinalColor=mix(finalColor,baseColor,digitalRainOptions.z);\ngl_FragColor=finalColor;\n}";var BABYLON;!(function(e){var t=(function(t){function n(n,o,r,i){var a=t.call(this,n,"sobeledgedetection",["width","height","edgeThickness"],["sceneSampler"],{width:o.getEngine().getRenderWidth(),height:o.getEngine().getRenderHeight()},o,e.Texture.TRILINEAR_SAMPLINGMODE,o.getEngine(),!0)||this;return a._edgeThickness=1,a._minEdgeThickness=.5,a._maxEdgeThickness=4,console.log("input thickness",r),a._edgeThickness=Math.min(Math.max(r,a._minEdgeThickness),a._maxEdgeThickness),a.onApply=function(e){e.setTextureFromPostProcess("sceneSampler",i),e.setFloat("width",a.width),e.setFloat("height",a.height),e.setFloat("edgeThickness",a._edgeThickness)},a}return __extends(n,t),n})(e.PostProcess);e.EdgeDetectionPostProcess=t})(BABYLON||(BABYLON={}));var BABYLON;!(function(e){var t=(function(t){function n(n,o,r,i){var a=t.call(this,n,"posterization",["gamma","numColors"],null,{width:o.getEngine().getRenderWidth(),height:o.getEngine().getRenderHeight()},o,e.Texture.TRILINEAR_SAMPLINGMODE,o.getEngine(),!0)||this;return a._gamma=.6,a._numColors=8,console.log("input gamma",r),a._gamma=r,console.log("input numColors",i),a._numColors=i,a.onApply=function(e){e.setFloat("gamma",a._gamma),e.setFloat("numColors",a._numColors)},a}return __extends(n,t),n})(e.PostProcess);e.PosterizationPostProcess=t})(BABYLON||(BABYLON={}));var BABYLON;!(function(e){var t=(function(t){function n(n,o,r,i,a,l,c){var s=t.call(this,n,"paper",null,["othertexture"],r,i,a,l,c)||this;return s._othertexture=null,s._othertexture=o?new e.Texture(o,i.getScene(),!0):null,s.onApplyObservable.add((function(e){e.setTexture("othertexture",s._othertexture)})),s}return __extends(n,t),n})(e.PostProcess);e.paperPostProcess=t})(BABYLON||(BABYLON={}));var BABYLON;!(function(e){var t=(function(e){function t(t,n,o,r,i,a,l){var c=e.call(this,t,"kuwahara",["radius","width","height"],null,{width:r.getEngine().getRenderWidth(),height:r.getEngine().getRenderHeight()},r,i,a,l)||this;return c._radius=3,"number"==typeof o&&(console.log("input radius",o),c._radius=o),c.onApplyObservable.add((function(e){e.setFloat("radius",c._radius),e.setFloat("width",c.width),e.setFloat("height",c.height)})),c}return __extends(t,e),t})(e.PostProcess);e.kuwaharaPostProcess=t})(BABYLON||(BABYLON={}));var BABYLON;!(function(e){var t=(function(t){function n(n,o,r,i,a,l,c){var s=t.call(this,n,"frame",null,["othertexture"],r,i,a,l,c)||this;return s._othertexture=null,s._othertexture=o?new e.Texture(o,i.getScene(),!0):null,s.onApplyObservable.add((function(e){e.setTexture("othertexture",s._othertexture)})),s}return __extends(n,t),n})(e.PostProcess);e.framePostProcess=t})(BABYLON||(BABYLON={})),BABYLON.Effect.ShadersStore.sobeledgedetectionPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D sceneSampler;\nuniform float width;\nuniform float height;\nuniform float edgeThickness;\nvoid make_kernel(inout vec4 n[9],sampler2D tex,vec2 coord)\n{\nfloat w=edgeThickness/width;\nfloat h=edgeThickness/height;\nn[0]=texture2D(tex,coord+vec2( -w,-h));\nn[1]=texture2D(tex,coord+vec2(0.0,-h));\nn[2]=texture2D(tex,coord+vec2( w,-h));\nn[3]=texture2D(tex,coord+vec2( -w,0.0));\nn[4]=texture2D(tex,coord);\nn[5]=texture2D(tex,coord+vec2( w,0.0));\nn[6]=texture2D(tex,coord+vec2( -w,h));\nn[7]=texture2D(tex,coord+vec2(0.0,h));\nn[8]=texture2D(tex,coord+vec2( w,h));\n}\nvoid main(void) \n{\nvec4 n[9];\nmake_kernel( n,sceneSampler,vUV );\nvec4 sobel_edge_h=n[2]+(2.0*n[5])+n[8]-(n[0]+(2.0*n[3])+n[6]);\nvec4 sobel_edge_v=n[0]+(2.0*n[1])+n[2]-(n[6]+(2.0*n[7])+n[8]);\nvec4 sobel=sqrt((sobel_edge_h*sobel_edge_h)+(sobel_edge_v*sobel_edge_v));\nfloat minGradChannel=min(sobel.r,min(sobel.g,sobel.b));\ngl_FragColor=vec4( 1.0-vec3(minGradChannel),1.0 );\n}\n",BABYLON.Effect.ShadersStore.posterizationPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform float gamma; \nuniform float numColors; \nvoid main(void) \n{ \nvec3 c=texture2D(textureSampler,vUV).rgb;\nc=pow(c,vec3(gamma,gamma,gamma));\nc=c*numColors;\nc=floor(c);\nc=c/numColors;\nc=pow(c,vec3(1.0/gamma));\ngl_FragColor=vec4(c,1.0);\n}\n",BABYLON.Effect.ShadersStore.composePixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\n\nuniform sampler2D sceneSampler;\nvoid main(void) \n{\n\ngl_FragColor=texture2D(textureSampler,vUV)*texture2D(sceneSampler,vUV);\n}",BABYLON.Effect.ShadersStore.paperPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D othertexture;\nvoid main(void) \n{\nvec3 color=texture2D(textureSampler,vUV).rgb*texture2D(othertexture,vUV).rgb;\ngl_FragColor=vec4(color,1.0);\n}",BABYLON.Effect.ShadersStore.kuwaharaPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform float radius;\nuniform float width;\nuniform float height;\nvoid main(void) \n{ \nint loopTimes=int(radius);\nvec2 src_size=vec2 (1.0/width,1.0/height);\nfloat n=(radius+1.0)*(radius+1.0);\nint i; \nint j;\nvec3 m0=vec3(0.0); vec3 m1=vec3(0.0); vec3 m2=vec3(0.0); vec3 m3=vec3(0.0);\nvec3 s0=vec3(0.0); vec3 s1=vec3(0.0); vec3 s2=vec3(0.0); vec3 s3=vec3(0.0);\nvec3 c;\nfor (int j=-loopTimes; j<=0; ++j) {\nfor (int i=-loopTimes; i<=0; ++i) {\nc=texture2D(textureSampler,vUV+vec2(i,j)*src_size).rgb;\nm0+=c;\ns0+=c*c;\n}\n}\nfor (int j=-loopTimes; j<=0; ++j) {\nfor (int i=0; i<=loopTimes; ++i) {\nc=texture2D(textureSampler,vUV+vec2(i,j)*src_size).rgb;\nm1+=c;\ns1+=c*c;\n}\n}\nfor (int j=0; j<=loopTimes; ++j) {\nfor (int i=0; i<=loopTimes; ++i) {\nc=texture2D(textureSampler,vUV+vec2(i,j)*src_size).rgb;\nm2+=c;\ns2+=c*c;\n}\n}\nfor (int j=0; j<=loopTimes; ++j) {\nfor (int i=-loopTimes; i<=0; ++i) {\nc=texture2D(textureSampler,vUV+vec2(i,j)*src_size).rgb;\nm3+=c;\ns3+=c*c;\n}\n}\nfloat min_sigma2=100.0;\nm0/=n;\ns0=abs(s0/n-m0*m0);\nfloat sigma2=s0.r+s0.g+s0.b;\nif (sigma2<min_sigma2) {\nmin_sigma2=sigma2;\ngl_FragColor=vec4(m0,1.0);\n}\nm1/=n;\ns1=abs(s1/n-m1*m1);\nsigma2=s1.r+s1.g+s1.b;\nif (sigma2<min_sigma2) {\nmin_sigma2=sigma2;\ngl_FragColor=vec4(m1,1.0);\n}\nm2/=n;\ns2=abs(s2/n-m2*m2);\nsigma2=s2.r+s2.g+s2.b;\nif (sigma2<min_sigma2) {\nmin_sigma2=sigma2;\ngl_FragColor=vec4(m2,1.0);\n}\n}",BABYLON.Effect.ShadersStore.framePixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D othertexture;\nvoid main(void) \n{\nvec3 framecolor=texture2D(othertexture,vUV).rgb;\nfloat alpha=texture2D(othertexture,vUV).a;\ngl_FragColor=vec4(texture2D(textureSampler,vUV).rgb*(1.0-alpha)+framecolor*alpha,1.0);\n}";var BABYLON;!(function(e){var t=(function(e){function t(t,n,o,r,i,a){var l=e.call(this,t,"rain",["time","width","height"],null,n,o,r,i,a)||this;l.degree=1,l._lastTime=0,l._lastDeltaTime=0;var c=o.getScene().getEngine().getDeltaTime();c!==l._lastDeltaTime&&(l._lastDeltaTime=c,l._lastTime+=l._lastDeltaTime);var s=0,f=0;return l.onApplyObservable.add((function(e){e.setFloat("width",o.getEngine().getRenderWidth()),e.setFloat("height",o.getEngine().getRenderHeight()),s+=.003,f=s,e.setFloat("time",10*f)})),l}return __extends(t,e),t})(e.PostProcess);e.rainPostProcess=t})(BABYLON||(BABYLON={})),BABYLON.Effect.ShadersStore.rainPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform float width;\nuniform float height;\nuniform float time;\n\n\n#define HASHSCALE1 443.8975\n#define HASHSCALE3 vec3(443.897,441.423,437.195)\n\nvec3 N31(float p) {\n\nvec3 p3=fract(vec3(p)*vec3(.1031,.11369,.13787));\np3+=dot(p3,p3.yzx+19.19);\nreturn fract(vec3((p3.x+p3.y)*p3.z,(p3.x+p3.z)*p3.y,(p3.y+p3.z)*p3.x));\n}\nvec3 hash31(float p)\n{\nvec3 p3=fract(vec3(p)*HASHSCALE3);\np3+=dot(p3,p3.yzx+19.19);\nreturn fract((p3.xxy+p3.yzz)*p3.zyx); \n}\nfloat SawTooth(float t) {\nreturn cos(t+cos(t))+sin(2.*t)*.2+sin(4.*t)*.02;\n}\nvec2 GetDrops(vec2 uv,float seed) {\nfloat t=time;\nuv.y+=t*0.05; \nuv*=vec2(40.,5.);\nvec2 id=floor(uv); \nvec3 n=N31(id.x+(id.y+seed)*546.3524); \nvec2 bd=fract(uv); \nbd-=.5; \n\nbd.y*=4.;\nbd.x+=(n.x-.5)*.6; \nt+=n.z*6.; \nfloat slide=SawTooth(t);\nbd.y+=slide*2.; \n\nfloat d=length(bd); \nvec2 normalbd=normalize(bd);\nfloat temp=-0.10*normalbd.y+0.20;\n\nfloat mainDrop=smoothstep(temp,.1,d);\nreturn bd*mainDrop;\n}\nvoid main(void)\n{\nvec2 uv=vUV;\nvec2 offs=vec2(0.);\noffs=GetDrops(uv*0.5,1.);\n\noffs+=GetDrops(uv*2.,25.);\nconst vec2 lensRadius=vec2(1.5,0.05);\nfloat dist=distance(uv.xy,vec2(0.5,0.5));\nfloat vigfin=pow(1.-smoothstep(lensRadius.x,lensRadius.y,dist),2.);\noffs*=vigfin*10.0;\nuv-=offs;\ngl_FragColor=texture2D(textureSampler,uv-offs);\n\n}\n";var BABYLON;!(function(e){var t=(function(t){function n(n,o,r,i,a,l,c){var s=t.call(this,n,"frost",["time","width","height"],["othertexture"],r,i,a,l,c)||this;s.degree=1,s.othertexture=null,s._lastTime=0,s._lastDeltaTime=0,s.othertexture=o?new e.Texture(o,i.getScene(),!0):null;var f=i.getScene().getEngine().getDeltaTime();f!==s._lastDeltaTime&&(s._lastDeltaTime=f,s._lastTime+=s._lastDeltaTime);var u=0,g=0;return s.onApplyObservable.add((function(e){e.setTexture("othertexture",s.othertexture),e.setFloat("width",i.getEngine().getRenderWidth()),e.setFloat("height",i.getEngine().getRenderHeight()),u+=.003,g=u,e.setFloat("time",10*g)})),s}return __extends(n,t),n})(e.PostProcess);e.frostPostProcess=t})(BABYLON||(BABYLON={})),BABYLON.Effect.ShadersStore.frostPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform sampler2D othertexture;\nuniform float width;\nuniform float height;\nuniform float time;\n#define FROSTYNESS 2.0\n#define COLORIZE 1.0\n#define COLOR_RGB 0.2,1.0,1.0\nfloat rand(vec2 uv) {\nfloat a=dot(uv,vec2(92.,80.));\nfloat b=dot(uv,vec2(41.,62.));\nfloat x=sin(a)+cos(b)*51.;\nreturn fract(x);\n}\n#define HASHSCALE1 .1031\nfloat hash12(vec2 p)\n{\nvec3 p3=fract(vec3(p.xyx)*HASHSCALE1);\np3+=dot(p3,p3.yzx+19.19);\nreturn fract((p3.x+p3.y)*p3.z);\n}\nvoid main( void)\n{\nvec2 uv=vUV;\nvec4 d=texture2D(othertexture,uv);\nvec2 rnd=vec2(rand(uv+d.r*.05),rand(uv+d.b*.05));\n\nconst vec2 lensRadius=vec2(2.0,0.05);\nfloat dist=distance(uv.xy,vec2(0.5,0.5));\nfloat vigfin=pow(1.-smoothstep(lensRadius.x,lensRadius.y,dist),2.);\nrnd*=.025*vigfin+d.rg*FROSTYNESS*vigfin;\nuv+=rnd;\ngl_FragColor=mix(texture2D(textureSampler,uv),vec4(COLOR_RGB,1.0),COLORIZE*vec4(rnd.r));\n}";var BABYLON;!(function(e){var t=(function(e){function t(t,n,o,r,i,a,l){var c=e.call(this,t,"pixelation",["width","height","pixel_w","pixel_h"],null,o,r,i,a,l)||this;return c._pixel_w=10,c._pixel_h=10,c._pixel_w=n[0],c._pixel_h=n[1],c.onApply=function(e){e.setFloat("width",c.width),e.setFloat("height",c.height),e.setFloat("pixel_w",c._pixel_w),e.setFloat("pixel_h",c._pixel_h)},c}return __extends(t,e),t})(e.PostProcess);e.pixelationPostProcess=t})(BABYLON||(BABYLON={})),BABYLON.Effect.ShadersStore.pixelationPixelShader="\nvarying vec2 vUV;\nuniform sampler2D textureSampler;\nuniform float width; \nuniform float height; \nuniform float pixel_w;\nuniform float pixel_h;\nvoid main() \n{ \n\n\n\nvec3 tc=vec3(1.0,0.0,0.0);\n\n\nfloat dx=pixel_w*(1.0/width);\nfloat dy=pixel_h*(1.0/height);\nvec2 coord=vec2(dx*floor(vUV.x/dx),\ndy*floor(vUV.y/dy));\ntc=texture2D(textureSampler,coord).rgb;\n\n\n\n\n\n\n\ngl_FragColor=vec4(tc,1.0);\n}",(function(e,t){var n=t();e&&e.BABYLON||("object"==typeof exports&&"object"==typeof module?module.exports=n:"function"==typeof define&&define.amd?define(["BJSPostProcess"],t):"object"==typeof exports?exports.BJSPostProcess=n:e.BABYLON=n)})(this,(function(){return BABYLON}));